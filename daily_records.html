<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Daily Records</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
</head>

<body class="dashboard">

<!-- SIDEBAR -->
<aside class="sidebar">
    <div class="logo">EastWest Shuttle</div>

    <ul class="menu">
        <li><a href="dashboard.html"><strong>Dashboard</strong></a></li>
        <li><a href="Account.html">Accounts</a></li>

        <li>
            <div class="dropdown-btn" onclick="toggleDropdown('shuttleMenu')">
                Shuttle ▾
            </div>
            <ul class="dropdown-menu" id="shuttleMenu">
                <li><a href="shuttle.html?id=1">Shuttle 1</a></li>
                <li><a href="shuttle.html?id=2">Shuttle 2</a></li>
                <li><a href="shuttle.html?id=3">Shuttle 3</a></li>
            </ul>
        </li>

        <li><a href="daily_records.html">Records</a></li>
    </ul>
</aside>

<!-- MAIN -->
<div class="main">

    <!-- TOPBAR -->
    <header class="topbar">
        <div class="user-dropdown">
            <button class="user-btn" onclick="toggleUserMenu()">John Doe ▾</button>
            <ul class="user-menu" id="userMenu">
                <li><a href="#">Edit Account</a></li>
                <li><a href="#">Logout</a></li>
            </ul>
        </div>
    </header>

    <!-- CONTENT -->
    <main class="content">

        <!-- FILTER + EXPORT -->
        <div class="top-controls">

            <div class="filter-bar">
                <div class="filter-group">
                    <label>From</label>
                    <input type="date" id="fromDate">
                </div>

                <div class="filter-group">
                    <label>To</label>
                    <input type="date" id="toDate">
                </div>

                <button class="primary-btn filter-btn" onclick="filterRecords()">Filter</button>
                <button class="secondary-btn clear-btn" onclick="clearFilter()">Clear</button>
            </div>

            <button class="primary-btn export-btn" onclick="exportExcel()">Export</button>
        </div>

        <!-- TABLE -->
        <section class="chart-box">
            <h4>All Records — All Shuttles</h4>

            <table id="dailyRecordsTable">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Time</th>
                        <th>Shuttle ID</th>
                        <th>Employee ID</th>
                    </tr>
                </thead>

                <tbody id="recordsBody">

                    <tr data-date="2024-01-05">
                        <td>January 5 2024</td>
                        <td>07:45 AM</td>
                        <td>Shuttle 1</td>
                        <td>EMP001</td>
                    </tr>

                    <tr data-date="2024-01-14">
                        <td>January 14 2024</td>
                        <td>08:30 AM</td>
                        <td>Shuttle 2</td>
                        <td>EMP002</td>
                    </tr>

                    <tr data-date="2024-01-25">
                        <td>January 25 2024</td>
                        <td>09:15 AM</td>
                        <td>Shuttle 3</td>
                        <td>EMP003</td>
                    </tr>

                    <tr data-date="2024-02-02">
                        <td>February 2 2024</td>
                        <td>07:50 AM</td>
                        <td>Shuttle 1</td>
                        <td>EMP004</td>
                    </tr>

                    <tr data-date="2024-02-10">
                        <td>February 10 2024</td>
                        <td>08:40 AM</td>
                        <td>Shuttle 2</td>
                        <td>EMP005</td>
                    </tr>

                    <tr data-date="2024-02-18">
                        <td>February 18 2024</td>
                        <td>09:05 AM</td>
                        <td>Shuttle 3</td>
                        <td>EMP006</td>
                    </tr>

                    <tr data-date="2024-03-01">
                        <td>March 1 2024</td>
                        <td>07:30 AM</td>
                        <td>Shuttle 1</td>
                        <td>EMP007</td>
                    </tr>

                    <tr data-date="2024-03-09">
                        <td>March 9 2024</td>
                        <td>08:10 AM</td>
                        <td>Shuttle 2</td>
                        <td>EMP008</td>
                    </tr>

                    <tr data-date="2024-03-15">
                        <td>March 15 2024</td>
                        <td>08:55 AM</td>
                        <td>Shuttle 3</td>
                        <td>EMP009</td>
                    </tr>

                    <tr data-date="2024-03-25">
                        <td>March 25 2024</td>
                        <td>09:20 AM</td>
                        <td>Shuttle 1</td>
                        <td>EMP010</td>
                    </tr>

                </tbody>
            </table>
        </section>

    </main>
</div>

<script>
function toggleDropdown(id) {
    const menu = document.getElementById(id);
    menu.style.display = menu.style.display === "block" ? "none" : "block";
}

function toggleUserMenu() {
    const menu = document.getElementById("userMenu");
    menu.style.display = menu.style.display === "block" ? "none" : "block";
}

window.addEventListener("click", e => {
    const btn = document.querySelector(".user-btn");
    const menu = document.getElementById("userMenu");
    if (!btn.contains(e.target) && !menu.contains(e.target)) {
        menu.style.display = "none";
    }
});

function filterRecords() {
    const from = document.getElementById("fromDate").value;
    const to = document.getElementById("toDate").value;

    document.querySelectorAll("#recordsBody tr").forEach(row => {
        const d = row.dataset.date;
        let show = true;

        if (from && d < from) show = false;
        if (to && d > to) show = false;

        row.style.display = show ? "" : "none";
    });
}

function clearFilter() {
    document.getElementById("fromDate").value = "";
    document.getElementById("toDate").value = "";

    document.querySelectorAll("#recordsBody tr").forEach(row => {
        row.style.display = "";
    });
}

function exportExcel() {
    const wb = XLSX.utils.table_to_book(
        document.getElementById("dailyRecordsTable"),
        { sheet: "Daily Records" }
    );
    XLSX.writeFile(wb, "daily_records.xlsx");
}
</script>

</body>
</html>
